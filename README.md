# ShiftHub

<img alt="スクリーンショット 2023-08-07 16 47 49" src="https://github.com/kokimoriguchi/ShiftApp/assets/105916391/933feb36-42a5-4ede-8b2d-72a2472a215a">
<br>

## **サービス URL**

https://web.realworld-demo.com

<br>

## 作成のきっかけ

前職でのシフト管理がスタッフは月末に次月のシフトを指定の紙に記述して提出しに出勤し、マネージャーはその紙を全て確認しシフトの調整を行っていた。
その業務フローを改善し一括確認できる様にしてお世話になっている上司の負担を減らしたいと感じたことがきっかけです。

<br>

## 前職での課題

### マネージャーサイド

- 40 人を超える従業員のシフトの紙を全て確認する手間
- 確定したシフトは 1 ヶ月分 40 人以上の名前と出勤日が書かれた A3 で張り出されるので字が小さく見ずらい。
- 繁忙期などの時間帯別での各カテゴリーの場所に人員配置できているかの確認でその紙では見づらいので単日のシフト表(31 枚)を全て印刷し確認している効率の悪さ
- 誰がどの加工技術を持っているのかが不明確なので、各カテゴリーの加工できる人がいない日がある。
- Excel を思い通りに使いこなせるわけではないので縦軸の名前の部分を固定できず月末の 31 に向かっていくと名前が見えず場所を覚えながら日付と出勤日を見ていく必要がある。

### スタッフサイド

- 忙しくあまり出勤できていない月でも紙なので月末までに記述した紙を提出しにこなければならない
- 確定したシフトは 1 ヶ月分 40 人の名前と出勤日が書かれた A3 で張り出されるので字が小さく見ずらい。
- 月の後半になると左側に記述のある自身の名前と合わせて見るのが大変。
- シフトは A3 の紙で印刷され張り出されるのでその紙の写真を撮り出勤日を確認している。

<br>

## 機能一覧

| トップ画面                                                                                                  | ダークモード画面                                                                                                 |
| ----------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------- |
| ![Top画面](https://github.com/kokimoriguchi/ShiftApp/assets/105916391/ca4fc924-765f-4532-9c37-a631f793e11d) | ![ダークモード](https://github.com/kokimoriguchi/ShiftApp/assets/105916391/4802aa58-a907-497d-89c3-67f6a68aed76) |
| ログイン画面、新規店舗登録、利用規約の画面に遷移できる様になっています。                                    | ハンバーガーメニュー内でダークモードの切り替えができ、全画面でダークモードが適用されるように実装しました。       |

| 新規店舗登録画面                                                                                                     | マネージャー作成画面                                                                                                     |
| -------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------ |
| ![新規店舗登録画面](https://github.com/kokimoriguchi/ShiftApp/assets/105916391/a9521855-ff5c-40a7-ae07-2f9d7512641c) | ![マネージャー作成画面](https://github.com/kokimoriguchi/ShiftApp/assets/105916391/38ec42bb-6c0a-42bc-ab1d-3477802c86ba) |
| 店名と店番を入力することで新規店舗登録可能にしています。                                                             | 店舗登録を行うとこの画面に遷移し 1 店舗に対して 1 人マネージャーを登録できる様にしています。                             |

| マネージャーログイン画面                                               | マネージャートップ画面                                                                                                      |
| ---------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------- |
| ![マネージャーログイン画面]()                                          | ![ マネージャートップ画面](https://github.com/kokimoriguchi/ShiftApp/assets/105916391/d173a9e0-aab5-40e6-9fe6-8155678242a3) |
| 登録した社員番号とパスワードを入力することでログイン可能にしています。 | header 部分に店舗名:従業員登録名表示する様実装しています。この画面からマネージャー権限のある作業画面に遷移できます。        |

| 新規スタッフ登録画面                                                                                                     | マスタの登録画面                                                                                                                                                                                                                                                                                                                                                                 |
| ------------------------------------------------------------------------------------------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ![新規スタッフ登録画面](https://github.com/kokimoriguchi/ShiftApp/assets/105916391/07edec35-639e-4061-8ad8-695b8193b9eb) | ![ スタッフ一覧画面](https://github.com/kokimoriguchi/ShiftApp/assets/105916391/7d064b68-0d47-4c3a-9279-cedf2d7daaee)                                                                                                                                                                                                                                                            |
| マネージャートップ画面から新規スタッフ登録可能です。                                                                     | スタッフ一覧画面でログインしている店舗に所属しているスタッフの氏名・社員番号を確認できます。チェックマークをつけて右下の削除ボタンを押し確認画面モーダルクリックするとチェックしたスタッフを削除できます。また skill 項目の add をクリックするとモーダル表示され店舗に登録されているスキル一覧が表示され、スタッフにスキルを可能スキルを割り振ることができる様に実装しています。 |

<br>

## 主な使用技術

### frontend

- JavaScript
- React(node14.17.1)
- TailwindCSS

### backend

- Ruby(3.1.0)
- Ruby on Rails(6.1.7)
  - API モード
- nginx(1.18)

### database

- MySQL(8.0)

### infra

- Docker
  - Docker compose
- AWS
  - ECS
  - ECR
  - Fargate
  - S3
  - Cloudfront

### CI/CD

- GitHubACtions

<br>

## 工夫した点

- 出勤可能日保存する際に出勤日の 複数のテーブルを扱い、かつ複数登録できる部分の shift＿dates テーブルと出勤時間の shift_times テーブル、そして employee テーブルとの中間テーブルの employer_shifts テーブルをトランザクションで保存するようにした点
- 認証に jwt トークンを使用し、cookie に保存することで認証可能にし、front 側で認証情報を扱わない様にしセキュリティを強めるよう Cookie の設定を行った。
- cookie に保存したデータは http only 属性と secure true を設定し front 側からの編集を不可にして https 通信のみ許可するように設定し backend の Rails 側からしか cookie にアクセスできないようにし、セキュリティ対策を行なっている点
- テーブルに is から始まる Boolean 型のカラムをセットし、true・false で認可されたかどうかの判定を行うようにしている点
- シフト提出の際に、一時保存としてローカルストレージに打ち込みをした時間を保存できるようにしたことでデータベースに保存しマネージャー側で確認できる状態にはせず自身で確認できる様にしたこと。
- 提出されたシフトは丸印で表示し、マネージャー側が調整して確定した場合に時間を表示できる様にしたこと。
- スキルチェックという項目を追加し、単日の出勤予定にスタッフが店舗で必要なスキルを持っているか確認できるようにした。useEffect 使用し即反映する様にしている。また、バツ印になっているスキルチェック項目はクリックすることで不足しているスキルが見れる様になっている。
- ダークモードの実装

<br>

## ER 図

<img src="https://github.com/kokimoriguchi/ShiftApp/assets/105916391/2f3cbce6-4b26-4025-accc-0cd3d199c537">

<br>

## インフラ構成図

<img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/2741017/bbd67865-9989-766c-dfe9-cb297a26ca7b.png">
